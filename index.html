<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Angel-åè¦‹è¦ºå¯Ÿ</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#B99B6B">
    <style>
        :root {
            color-scheme: light; 
            --bg-start: #F9F5F0; --bg-end: #F2E9E1;
            --text-main: #5D5245; --accent-soft: #B99B6B;
            --white: rgba(255, 255, 255, 0.98);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; font-family: "PingFang TC", "Noto Sans TC", sans-serif;
            height: 100dvh; background: linear-gradient(135deg, var(--bg-start), var(--bg-end)) !important;
            color: var(--text-main) !important; display: flex; justify-content: center; overflow: hidden;
        }
        .container { 
            width: 100%; max-width: 480px; height: 100dvh; 
            padding: 20px 25px; display: flex; flex-direction: column; 
            align-items: center; justify-content: space-between; 
            padding-bottom: calc(env(safe-area-inset-bottom) + 20px); 
        }
        .page { width: 100%; animation: fadeIn 0.6s ease; display: none; height: 100%; flex-direction: column; align-items: center; justify-content: center; }
        #home-page { display: flex; }

        header { text-align: center; margin-bottom: 20px; }
        h1 { font-weight: 300; font-size: 1.8rem; letter-spacing: 6px; margin: 0; }

        /* èªéŸ³é–‹é—œæ¨£å¼ */
        .voice-toggle {
            display: flex; align-items: center; gap: 10px; margin-bottom: 25px;
            padding: 10px 20px; background: var(--white); border-radius: 50px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05); cursor: pointer;
        }
        .toggle-label { font-size: 0.9rem; letter-spacing: 1px; }

        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; width: 100%; }
        .nav-btn {
            background: var(--white) !important; border: 1px solid rgba(185, 155, 107, 0.15);
            border-radius: 25px; display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            color: var(--text-main) !important; box-shadow: 0 8px 20px rgba(93, 82, 69, 0.08);
            cursor: pointer; transition: transform 0.2s;
        }
        .menu-btn { aspect-ratio: 1 / 1.15; font-size: 1.1rem; }
        .menu-btn span { font-size: 2.5rem; margin-bottom: 10px; }

        .timer-container { position: relative; width: 140px; height: 140px; margin-bottom: 30px; display: flex; align-items: center; justify-content: center; }
        .breath-circle { position: absolute; width: 100%; height: 100%; background: radial-gradient(circle, #F2D388 0%, transparent 70%); border-radius: 50%; filter: blur(12px); animation: breathe 10s ease-in-out infinite; }
        #timer-number { font-size: 2rem; font-weight: 300; color: var(--accent-soft); z-index: 2; }

        .step-box { min-height: 200px; text-align: center; }
        .sense-tag { font-size: 0.85rem; color: var(--accent-soft); letter-spacing: 4px; margin-bottom: 20px; font-weight: bold; }
        .guide-line { display: block; margin-bottom: 5px; }

        @keyframes breathe { 0%, 100% { transform: scale(0.8); opacity: 0.3; } 50% { transform: scale(1.3); opacity: 0.7; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .footer-hint { font-size: 0.85rem; opacity: 0.5; margin-top: 20px; }
    </style>
</head>
<body>

<div class="container">
    <div id="home-page" class="page">
        <header><h1>Angel</h1></header>
        
        <div class="voice-toggle" onclick="toggleVoice()">
            <span id="voice-icon">ğŸ”Š</span>
            <span class="toggle-label" id="voice-text">èªéŸ³å°å¼•ï¼šé–‹å•Ÿ</span>
        </div>

        <div class="menu-grid">
            <button class="nav-btn menu-btn" onclick="start('kids')"><span>ğŸ¨</span>å°å°å­©</button>
            <button class="nav-btn menu-btn" onclick="start('primary')"><span>ğŸ’</span>å­©å­å€‘</button>
            <button class="nav-btn menu-btn" onclick="start('teen')"><span>ğŸ§</span>é’å°‘å¹´</button>
            <button class="nav-btn menu-btn" onclick="start('adult')"><span>ğŸŒ¿</span>çµ¦è‡ªå·±</button>
        </div>
        <p class="footer-hint">é¸ä¸€å€‹èº«åˆ†ï¼Œé–‹å§‹ 30 ç§’ç©©å®šç·´ç¿’</p>
    </div>

    <div id="content-page" class="page">
        <div class="timer-container">
            <div class="breath-circle"></div>
            <div id="timer-number">10</div>
        </div>
        <div class="step-box" id="step-box"></div>
        <button id="finish-btn" class="nav-btn" style="display:none; width:100%; height:60px; font-weight:bold;" onclick="location.reload()">ç·´ç¿’å®Œæˆ</button>
    </div>
</div>

<script>
    // éš¨æ©Ÿæ± è³‡æ–™åº«
    const pool = {
        kids: [
            [{sense:"ğŸ‘€ è¦–è¦º", text:"å¿ƒè£¡ç¾åœ¨æ˜¯ä»€éº¼é¡è‰²ï¼Ÿ"}, {sense:"âœ‹ è§¸è¦º", text:"æƒ³åƒé€™é¡è‰²åƒæ£‰èŠ±ç³–ä¸€æ¨£è»Ÿã€‚"}, {sense:"ğŸŒ¬ï¸ å—…è¦º", text:"èèçœ‹ï¼Œå®ƒæœ‰è‰è“çš„å‘³é“å—ï¼Ÿ"}],
            [{sense:"ğŸ‘€ è¦–è¦º", text:"æƒ³åƒè…¦æµ·è£¡æœ‰ä¸€æœµå°é›²ã€‚"}, {sense:"âœ‹ è§¸è¦º", text:"æ‘¸æ‘¸é€™æœµé›²ï¼Œæ˜¯æ¶¼æ¶¼çš„å—ï¼Ÿ"}, {sense:"ğŸŒ¬ï¸ å—…è¦º", text:"æ·±å‘¼å¸ï¼Œèåˆ°ä¸‹é›¨çš„å‘³é“äº†å—ï¼Ÿ"}]
        ],
        primary: [
            [{sense:"ğŸ‘‚ è½è¦º", text:"è½è½çœ‹ï¼Œæœ€é çš„ä¸€å€‹è²éŸ³ã€‚"}, {sense:"ğŸ‘€ è¦–è¦º", text:"æ‰¾æ‰¾çœ‹ï¼Œä¸‰å€‹è—è‰²çš„æ±è¥¿ã€‚"}, {sense:"ğŸ§˜ ç©©å®š", text:"æ„Ÿè¦ºè…³è¶¾é ­æŠ“åœ°çš„åŠ›é‡ã€‚"}],
            [{sense:"ğŸ‘‚ è½è¦º", text:"è½è½çœ‹ï¼Œé›¢ä½ æœ€è¿‘çš„è²éŸ³ã€‚"}, {sense:"ğŸ‘€ è¦–è¦º", text:"æ‰¾æ‰¾çœ‹ï¼Œä¸‰å€‹åœ“åœ“çš„æ±è¥¿ã€‚"}, {sense:"ğŸ§˜ ç©©å®š", text:"æ„Ÿè¦ºé›™æ‰‹æ”¾åœ¨å¤§è…¿çš„é‡é‡ã€‚"}]
        ],
        teen: [
            [{sense:"âœ‹ è§¸è¦º", text:"æ‘¸æ‘¸è¡£æœï¼Œæ˜¯ç²—ç³™é‚„æ˜¯æŸ”è»Ÿï¼Ÿ"}, {sense:"ğŸ‘ƒ å—…è¦º", text:"æ„Ÿè¦ºå†·ç©ºæ°£é€²åˆ°é¼»è…”ã€‚"}, {sense:"ğŸ§  è¦ºå¯Ÿ", text:"æˆ‘ç¾åœ¨çš„å®‰å…¨æ„Ÿåœ¨å“ªè£¡ï¼Ÿ"}],
            [{sense:"âœ‹ è§¸è¦º", text:"æ„Ÿè¦ºä½ çš„èƒŒï¼Œé åœ¨æ¤…å­ä¸Šçš„æ„Ÿè¦ºã€‚"}, {sense:"ğŸ‘ƒ å—…è¦º", text:"æ…¢æ…¢å¸æ°£ï¼Œæ„Ÿè¦ºè‚ºéƒ¨å¡«æ»¿ã€‚"}, {sense:"ğŸ§  è¦ºå¯Ÿ", text:"çµ¦ç¾åœ¨çš„æƒ…ç·’èµ·ä¸€å€‹åå­—ã€‚"}]
        ],
        adult: [
            [{sense:"ğŸŒ ç©ºé–“", text:"é€™ä»½æƒ…ç·’æ˜¯å±¬æ–¼ç¾åœ¨å—ï¼Ÿ"}, {sense:"ğŸ‘‚ è½è¦º", text:"è½è½å‘¼å¸ï¼Œæ˜¯æ€¥ä¿ƒé‚„æ˜¯å¹³ç·©ï¼Ÿ"}, {sense:"ğŸŒ¿ æ•´åˆ", text:"çœ‹è¦‹åè¦‹ï¼Œä½†æˆ‘é¸æ“‡æº«å’Œå°å¾…ã€‚"}],
            [{sense:"ğŸŒ ç©ºé–“", text:"æ„Ÿè¦ºä½ çš„é›™è…³è¸å¯¦åœ°è¸©åœ¨åœ°ä¸Šã€‚"}, {sense:"ğŸ‘‚ è½è¦º", text:"ç•™æ„ç’°å¢ƒä¸­è¢«å¿½ç•¥çš„èƒŒæ™¯éŸ³ã€‚"}, {sense:"ğŸŒ¿ æ•´åˆ", text:"æ¥ç´æ··äº‚ï¼Œçµ¦è‡ªå·±ä¸€çµ²ç©ºé–“ã€‚"}]
        ]
    };

    let isVoiceEnabled = true;
    let currentSteps = [];
    let currentIdx = 0;
    let timerInterval;

    function toggleVoice() {
        isVoiceEnabled = !isVoiceEnabled;
        document.getElementById('voice-icon').innerText = isVoiceEnabled ? "ğŸ”Š" : "ğŸ”‡";
        document.getElementById('voice-text').innerText = `èªéŸ³å°å¼•ï¼š${isVoiceEnabled ? 'é–‹å•Ÿ' : 'é—œé–‰'}`;
        if (!isVoiceEnabled) window.speechSynthesis.cancel();
    }

    function start(type) {
        // éš¨æ©Ÿå¾æ± å­é¸ä¸€çµ„ç·´ç¿’
        const options = pool[type];
        currentSteps = options[Math.floor(Math.random() * options.length)];
        currentIdx = 0;
        document.getElementById('home-page').style.display = 'none';
        document.getElementById('content-page').style.display = 'flex';
        runStep();
    }

    function runStep() {
        if (currentIdx >= currentSteps.length) { finish(); return; }
        const item = currentSteps[currentIdx];
        document.getElementById('step-box').innerHTML = `
            <div class="sense-tag">${item.sense}</div>
            <div class="step-text">${item.text.replace(/ï¼Œ/g, '<br>')}</div>
        `;
        if (isVoiceEnabled) speak(item.text);
        startTimer(10, () => { currentIdx++; runStep(); });
    }

    function startTimer(seconds, callback) {
        let timeLeft = seconds;
        const display = document.getElementById('timer-number');
        display.innerText = timeLeft;
        clearInterval(timerInterval);
        timerInterval = setInterval(() => {
            timeLeft--; display.innerText = timeLeft;
            if (timeLeft <= 0) { clearInterval(timerInterval); callback(); }
        }, 1000);
    }

    function speak(content) {
        window.speechSynthesis.cancel();
        const utterance = new SpeechSynthesisUtterance(content);
        utterance.lang = 'zh-TW'; utterance.rate = 0.8;
        window.speechSynthesis.speak(utterance);
    }

    function finish() {
        clearInterval(timerInterval);
        document.getElementById('timer-number').innerText = "âœ¨";
        document.getElementById('step-box').innerHTML = `<div class="sense-tag">ç·´ç¿’é”æˆ</div><div class="step-text">è¬è¬ä½ ï¼Œé™ªè‡ªå·±èµ°äº†é€™æ®µè·¯ã€‚</div>`;
        document.getElementById('finish-btn').style.display = 'block';
    }
</script>
</body>
</html>
