<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Angel-åè¦‹è¦ºå¯Ÿ</title>
    <style>
        :root {
            --bg-deep: #3D523D;
            --text-light: #F2E9E1;
            --accent-gold: #F2D388;
            --card-glass: rgba(255, 255, 255, 0.1);
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            margin: 0; font-family: "PingFang TC", sans-serif;
            height: 100dvh; background-color: var(--bg-deep);
            color: var(--text-light); display: flex; justify-content: center; overflow: hidden;
        }
        .container { 
            width: 100%; max-width: 480px; height: 100dvh; 
            padding: 20px; display: flex; flex-direction: column; 
            align-items: center; justify-content: space-between;
        }
        .page { width: 100%; display: none; flex-direction: column; align-items: center; }
        #home-page { display: flex; animation: fadeIn 0.8s ease; }

        header h1 { font-weight: 200; font-size: 2rem; letter-spacing: 10px; color: var(--accent-gold); margin: 10px 0; }
        .intro-text { font-size: 0.85rem; opacity: 0.8; line-height: 1.6; margin-bottom: 20px; text-align: center; }

        /* é¸é …å€å¡Š */
        .section-label { font-size: 0.75rem; letter-spacing: 2px; margin: 15px 0 8px; opacity: 0.6; align-self: flex-start; }
        .option-row {
            width: 100%; background: var(--card-glass); border-radius: 50px;
            padding: 4px; display: flex; border: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 5px;
        }
        .opt-item { flex: 1; text-align: center; font-size: 0.7rem; cursor: pointer; opacity: 0.4; padding: 10px 0; border-radius: 30px; transition: 0.3s; }
        .opt-item.active { opacity: 1; background: var(--accent-gold); color: var(--bg-deep); font-weight: bold; }

        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; width: 100%; margin-top: 15px; }
        .nav-btn { background: var(--card-glass); border: 1px solid rgba(255,255,255,0.1); border-radius: 20px; color: var(--text-light); cursor: pointer; }
        .menu-btn { aspect-ratio: 1.1 / 1; font-size: 1rem; }
        .menu-btn span { font-size: 2rem; display: block; margin-bottom: 5px; }

        /* ç·´ç¿’é  */
        .breath-circle { 
            width: 130px; height: 130px; background: radial-gradient(circle, var(--accent-gold) 0%, transparent 70%); 
            border-radius: 50%; filter: blur(10px); animation: breathe 8s infinite; margin: 40px 0;
            display: flex; align-items: center; justify-content: center;
        }
        #timer-display { font-size: 2.2rem; font-weight: 200; color: white; filter: blur(0); }

        .step-box { min-height: 160px; text-align: center; width: 100%; }
        .sense-tag { font-size: 0.8rem; color: var(--accent-gold); letter-spacing: 5px; margin-bottom: 10px; }
        .step-text { font-size: 1.3rem; line-height: 1.8; }

        .journal-box { width: 100%; margin-top: 20px; display:none; }
        .journal-input { width: 100%; background: var(--card-glass); border: 1px solid rgba(255,255,255,0.1); color: white; padding: 15px; border-radius: 15px; resize: none; }

        @keyframes breathe { 0%, 100% { transform: scale(0.9); opacity: 0.3; } 50% { transform: scale(1.2); opacity: 0.6; } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

<audio id="bg-music" loop playsinline></audio>
<audio id="bell-sound" playsinline></audio>

<div class="container">
    <div id="home-page" class="page">
        <header><h1>Angel</h1><div class="intro-text">ç•¶ä½ æ„Ÿåˆ°åè¦‹æˆ–ç…©èºæ™‚ï¼Œ<br>èˆ‡æ„Ÿå®˜é€£çµï¼Œæ‰¾å›å…§åœ¨å¹³éœã€‚</div></header>

        <div class="section-label">èƒŒæ™¯éŸ³æ¨‚ï¼ˆæ¥µè‡´èˆ’ç·©ï¼‰</div>
        <div class="option-row" id="music-row">
            <div class="opt-item active" onclick="setMusic('none')">å¯‚éœ</div>
            <div class="opt-item" onclick="setMusic('sea')">æ·±æµ·</div>
            <div class="opt-item" onclick="setMusic('wind')">å¾®é¢¨</div>
            <div class="opt-item" onclick="setMusic('space')">æ˜Ÿç©º</div>
        </div>

        <div class="section-label">æ¯é¡Œåœç•™æ™‚é•·</div>
        <div class="option-row" id="time-row">
            <div class="opt-item active" onclick="setTime(10)">10ç§’</div>
            <div class="opt-item" onclick="setTime(20)">20ç§’</div>
            <div class="opt-item" onclick="setTime(30)">30ç§’</div>
        </div>

        <div class="section-label">æç¤ºéŸ³æ•ˆ</div>
        <div class="option-row" id="bell-row">
            <div class="opt-item active" onclick="setBell('bowl')">é Œç¼½</div>
            <div class="opt-item" onclick="setBell('chime')">é¢¨éˆ´</div>
            <div class="opt-item" onclick="setBell('mute')">ç„¡è²</div>
        </div>

        <div class="menu-grid">
            <button class="nav-btn menu-btn" onclick="start('kids')"><span>ğŸ¨</span>å°å°å­©</button>
            <button class="nav-btn menu-btn" onclick="start('adult')"><span>ğŸŒ¿</span>çµ¦è‡ªå·±</button>
        </div>
        
        <div style="font-size: 0.7rem; margin-top: 20px; opacity: 0.5;">
            <a href="æ‚¨çš„è¡¨å–®é€£çµ" style="color: white;">ğŸ“‹ æä¾›ä½¿ç”¨å›é¥‹</a>
        </div>
    </div>

    <div id="content-page" class="page">
        <div class="breath-circle"><div id="timer-display"></div></div>
        <div class="step-box" id="step-box"></div>
        <div id="journal-area" class="journal-box">
            <textarea class="journal-input" id="note" placeholder="æ­¤åˆ»çš„å¿ƒæƒ…æ˜¯... ğŸ“"></textarea>
            <button class="nav-btn" style="width:100%; padding:15px; margin-top:10px;" onclick="location.reload()">å®Œæˆç·´ç¿’</button>
        </div>
    </div>
</div>

<script>
    const musicLib = {
        none: "",
        sea: "https://actions.google.com/sounds/v1/ambiences/deep_hum.ogg",
        wind: "https://actions.google.com/sounds/v1/ambiences/wind_in_trees.ogg",
        space: "https://actions.google.com/sounds/v1/ambiences/soft_low_hum.ogg"
    };

    const bellLib = {
        bowl: "https://actions.google.com/sounds/v1/alarms/digital_watch_alarm_long.ogg", // æš«ä»£ï¼Œå»ºè­°æ›æˆé Œç¼½mp3
        chime: "https://actions.google.com/sounds/v1/clocks/mechanical_clock_ring.ogg",
        mute: ""
    };

    const pool = {
        kids: [{s:"ğŸ‘€ è¦–è¦º", t:"çœ‹çœ‹çª—å¤–ï¼Œæ‰¾ä¸€å€‹ç¶ è‰²çš„æ±è¥¿ã€‚"}, {s:"âœ‹ è§¸è¦º", t:"æ‘¸æ‘¸è‡ªå·±çš„æ‰‹å¿ƒï¼Œæ˜¯æš–æš–çš„å—ï¼Ÿ"}, {s:"ğŸŒ¬ï¸ å—…è¦º", t:"æ·±å‘¼å¸ï¼Œèèç©ºæ°£çš„å‘³é“ã€‚"}],
        adult: [{s:"ğŸŒ ç©ºé–“", t:"æ„Ÿè¦ºèº«é«”åœ¨æ¤…å­ä¸Šçš„é‡é‡ã€‚"}, {s:"ğŸ‘‚ è½è¦º", t:"ç•™æ„æˆ¿é–“å…§æœ€å¾®å¼±çš„è²éŸ³ã€‚"}, {s:"ğŸŒ¿ æ•´åˆ", t:"å°è‡ªå·±èªªï¼šæˆ‘ç¾åœ¨å¾ˆå®‰å…¨ã€‚"}]
    };

    let cfg = { music: 'none', time: 10, bell: 'bowl' };
    let stepIdx = 0;

    function setMusic(k) { cfg.music = k; updateUI('music-row', k); }
    function setTime(v) { cfg.time = v; updateUI('time-row', v); }
    function setBell(k) { cfg.bell = k; updateUI('bell-row', k); }

    function updateUI(id, val) {
        const row = document.getElementById(id);
        Array.from(row.children).forEach((el, i) => {
            el.classList.toggle('active', el.innerText.includes(val) || (id==='music-row' && i===['none','sea','wind','space'].indexOf(val)));
        });
    }

    function start(type) {
        const music = document.getElementById('bg-music');
        if(cfg.music !== 'none') { music.src = musicLib[cfg.music]; music.volume = 0.2; music.play(); }
        
        document.getElementById('home-page').style.display = 'none';
        document.getElementById('content-page').style.display = 'flex';
        run(pool[type]);
    }

    function run(steps) {
        if(stepIdx >= steps.length) { 
            document.getElementById('step-box').innerHTML = "ç·´ç¿’å®Œæˆ âœ¨";
            document.getElementById('journal-area').style.display = 'block';
            return; 
        }
        
        const item = steps[stepIdx];
        document.getElementById('step-box').innerHTML = `<div class="sense-tag">${item.s}</div><div class="step-text">${item.t}</div>`;
        
        // æç¤ºéŸ³
        if(cfg.bell !== 'mute') {
            const b = document.getElementById('bell-sound');
            b.src = bellLib[cfg.bell]; b.play();
        }

        // èªéŸ³
        const u = new SpeechSynthesisUtterance(item.t); u.lang = 'zh-TW'; u.rate = 0.8;
        window.speechSynthesis.speak(u);

        let count = cfg.time;
        document.getElementById('timer-display').innerText = count;
        let timer = setInterval(() => {
            count--;
            document.getElementById('timer-display').innerText = count > 0 ? count : "âœ¨";
            if(count <= 0) { clearInterval(timer); stepIdx++; run(steps); }
        }, 1000);
    }
</script>
</body>
</html>
