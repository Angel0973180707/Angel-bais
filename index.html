<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Angel-åè¦‹è¦ºå¯Ÿ</title>
    <style>
        :root { --bg: #3D523D; --light: #F2E9E1; --gold: #F2D388; --glass: rgba(255, 255, 255, 0.1); }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; font-family: -apple-system, sans-serif; height: 100dvh; background: var(--bg); color: var(--light); display: flex; justify-content: center; overflow: hidden; }
        .container { width: 100%; max-width: 400px; height: 100%; padding: 10px 15px; display: flex; flex-direction: column; justify-content: space-between; }
        
        header h1 { font-size: 1.5rem; letter-spacing: 5px; color: var(--gold); margin: 5px 0; text-align: center; font-weight: 300; }
        .intro { font-size: 0.75rem; opacity: 0.7; margin-bottom: 8px; text-align: center; line-height: 1.4; }

        .label { font-size: 0.7rem; opacity: 0.6; margin: 8px 0 4px; letter-spacing: 1px; }
        .row { width: 100%; background: var(--glass); border-radius: 20px; padding: 2px; display: flex; border: 1px solid rgba(255,255,255,0.1); }
        .opt { flex: 1; text-align: center; font-size: 0.75rem; cursor: pointer; opacity: 0.5; padding: 8px 0; border-radius: 18px; transition: 0.3s; }
        .opt.active { opacity: 1; background: var(--gold); color: var(--bg); font-weight: bold; }

        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; margin: 10px 0; }
        .btn { background: var(--glass); border: 1px solid rgba(255,255,255,0.1); border-radius: 15px; color: var(--light); padding: 12px; text-align: center; cursor: pointer; }
        .btn span { font-size: 1.5rem; display: block; margin-bottom: 2px; }
        .btn p { margin: 0; font-size: 0.85rem; letter-spacing: 1px; }

        .footer { font-size: 0.7rem; opacity: 0.4; text-align: center; padding-bottom: 10px; }
        .footer a { color: var(--light); text-decoration: none; }

        .page { display: none; height: 100%; flex-direction: column; align-items: center; justify-content: center; }
        .circle { width: 110px; height: 110px; background: radial-gradient(circle, var(--gold) 0%, transparent 70%); border-radius: 50%; display: flex; align-items: center; justify-content: center; animation: b 4s infinite; margin-bottom: 30px; }
        #timer { font-size: 2rem; font-weight: 200; }
        .step-box { min-height: 120px; text-align: center; width: 100%; padding: 0 20px; }
        @keyframes b { 0%,100% {transform: scale(0.9); opacity: 0.4;} 50% {transform: scale(1.1); opacity: 0.7;} }
    </style>
</head>
<body>

<audio id="bg-m" loop playsinline></audio>
<audio id="be-m" playsinline></audio>

<div class="container">
    <div id="home-page" style="display: flex; flex-direction: column; height: 100%;">
        <header><h1>Angel</h1><div class="intro">ç•¶ä½ æ„Ÿåˆ°ç…©èºæ™‚ï¼Œèˆ‡æ„Ÿå®˜é€£çµ<br>æ‰¾å›å…§åœ¨å¹³éœ</div></header>

        <div class="label">èƒŒæ™¯æ°›åœéŸ³</div>
        <div class="row" id="m-row">
            <div id="m-none" class="opt active" onclick="set('m','none')">å¯‚éœ</div>
            <div id="m-sea" class="opt" onclick="set('m','sea')">æ·±æµ·</div>
            <div id="m-zen" class="opt" onclick="set('m','zen')">ç¦ªå®š</div>
        </div>

        <div class="label">æ¯é¡Œåœç•™æ™‚é–“</div>
        <div class="row" id="t-row">
            <div id="t-10" class="opt active" onclick="set('t',10)">10ç§’</div>
            <div id="t-20" class="opt" onclick="set('t',20)">20ç§’</div>
            <div id="t-30" class="opt" onclick="set('t',30)">30ç§’</div>
        </div>

        <div class="label">æ›é¡Œæç¤ºéŸ³</div>
        <div class="row" id="b-row">
            <div id="b-bowl" class="opt active" onclick="set('b','bowl')">é Œç¼½</div>
            <div id="b-mute" class="opt" onclick="set('b','mute')">ç„¡è²</div>
        </div>

        <div class="grid">
            <div class="btn" onclick="go('kids')"><span>ğŸ¨</span><p>å°å°å­©</p></div>
            <div class="btn" onclick="go('primary')"><span>ğŸ’</span><p>å­©å­å€‘</p></div>
            <div class="btn" onclick="go('teen')"><span>ğŸ§</span><p>é’å°‘å¹´</p></div>
            <div class="btn" onclick="go('adult')"><span>ğŸŒ¿</span><p>çµ¦è‡ªå·±</p></div>
        </div>
        
        <div class="footer"><a href="#">ğŸ“ æä¾›ä½¿ç”¨å›é¥‹</a></div>
    </div>

    <div id="content-page" class="page">
        <div class="circle"><div id="timer"></div></div>
        <div class="step-box" id="step-box"></div>
    </div>
</div>

<script>
    // å…¨éƒ¨ä½¿ç”¨ MP3 æ ¼å¼ç¢ºä¿ iOS æ’­æ”¾
    const mLib = { 
        none: "", 
        sea: "https://assets.mixkit.co/music/preview/mixkit-deep-ocean-hum-1549.mp3", 
        zen: "https://assets.mixkit.co/music/preview/mixkit-dreaming-big-31.mp3" 
    };
    const bLib = { 
        bowl: "https://www.soundjay.com/misc/sounds/bell-ringing-05.mp3", 
        mute: "" 
    };
    
    const pool = {
        kids: [{s:"ğŸ‘€ è¦–è¦º", t:"æ‰¾ä¸€å€‹ä½ æœ€å–œæ­¡çš„é¡è‰²ã€‚"}, {s:"âœ‹ è§¸è¦º", t:"æ‘¸æ‘¸è¡£æœï¼Œæ„Ÿè¦ºè»Ÿè»Ÿçš„ã€‚"}],
        primary: [{s:"ğŸ‘‚ è½è¦º", t:"è½è½çœ‹ï¼Œé æ–¹æœ‰ä»€éº¼è²éŸ³ï¼Ÿ"}, {s:"ğŸ‘€ è¦–è¦º", t:"æ‰¾å‡ºä¸‰å€‹åœ“åœ“çš„æ±è¥¿ã€‚"}],
        teen: [{s:"âœ‹ è§¸è¦º", t:"æ„Ÿè¦ºé›™æ‰‹åˆåçš„æº«åº¦ã€‚"}, {s:"ğŸŒ¬ï¸ å‘¼å¸", t:"æ·±æ·±å¸æ°£ï¼Œæ„Ÿè¦ºè…¹éƒ¨éš†èµ·ã€‚"}],
        adult: [{s:"ğŸŒ ç©ºé–“", t:"æ„Ÿè¦ºèº«é«”è¢«æ¤…èƒŒæ”¯æ’çš„åŠ›é‡ã€‚"}, {s:"ğŸ‘‚ è½è¦º", t:"ç•™æ„ç©ºé–“ä¸­æœ€ç´°å¾®çš„å®‰éœã€‚"}]
    };

    let cfg = { m: 'none', t: 10, b: 'bowl' };

    function set(type, val) {
        cfg[type] = val;
        // æ¸…é™¤è©²åˆ—æ‰€æœ‰ active ä¸¦é‡æ–°åŠ ä¸Š
        const items = document.getElementById(type + '-row').children;
        for (let i of items) i.classList.remove('active');
        document.getElementById(type + '-' + val).classList.add('active');
    }

    function go(type) {
        const music = document.getElementById('bg-m');
        const bell = document.getElementById('be-m');
        
        // ã€æ ¸å¿ƒä¿®æ­£ã€‘åœ¨é»æ“Šç¬é–“å¼·åˆ¶è§¸ç™¼éŸ³è¨Šè¼‰å…¥
        if(cfg.m !== 'none') {
            music.src = mLib[cfg.m];
            music.load(); 
            music.play().catch(e => console.log("èƒŒæ™¯éŸ³è¢«é˜»æ””"));
        }
        if(cfg.b !== 'mute') {
            bell.src = bLib[cfg.b];
            bell.load();
        }

        document.getElementById('home-page').style.display = 'none';
        document.getElementById('content-page').style.display = 'flex';
        play(pool[type]);
    }

    function play(steps) {
        let idx = 0;
        const run = () => {
            if (idx >= steps.length) { 
                document.getElementById('step-box').innerHTML = "ç·´ç¿’å®Œæˆ âœ¨";
                setTimeout(() => location.reload(), 3000);
                return; 
            }
            const item = steps[idx];
            document.getElementById('step-box').innerHTML = `<div style="color:var(--gold);margin-bottom:10px;font-size:0.9rem;letter-spacing:5px;">${item.s}</div><div style="font-size:1.3rem;line-height:1.8;">${item.t}</div>`;
            
            // æ’­æ”¾æç¤ºéŸ³
            if(cfg.b !== 'mute') {
                const b = document.getElementById('be-m');
                b.currentTime = 0;
                b.play().catch(() => {});
            }
            
            // èªéŸ³æ’­æ”¾
            const u = new SpeechSynthesisUtterance(item.t); 
            u.lang = 'zh-TW'; u.rate = 0.8;
            window.speechSynthesis.speak(u);

            let c = cfg.t;
            document.getElementById('timer').innerText = c;
            const t = setInterval(() => {
                c--;
                document.getElementById('timer').innerText = c > 0 ? c : "âœ¨";
                if (c <= 0) { clearInterval(t); idx++; setTimeout(run, 1000); }
            }, 1000);
        };
        run();
    }
</script>
</body>
</html>
